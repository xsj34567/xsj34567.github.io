---
layout: post
title:  "初识微服务"
date:   2018-07-01
categories: 微服务
tags: 微服务 SpringBoot SpringCloud
updateTime: 2021-04-08
---

* content
 {:toc}

## 一、微服务

了解基本概念：分布式、集群、微服务...

分布式：把一个应用拆成几个应用部署到不同的机器上

集群：同一个应用部署到不同的机器上

微服务：比分布式拆分应用的颗粒度更细，拆分为单个的服务，比如用户服务、短信服务...

### 1.微服务架构

[来源于网络:https://gitee.com/xushj/flowchart/blob/master/language/java/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E5%9B%BE/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84.jpg](https://gitee.com/xushj/flowchart/blob/master/language/java/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E5%9B%BE/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84.jpg)

### 2.微服务组件

#### 2.1 配置中心

常用做配置中心的组件：db、file、git、apolloconfig、consul、etcd3、nacos、zk

| 名称                                                      | 核心                                                         | 优劣                                                         |
| :-------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| db                                                        | 将配置信息存于数据库中                                       | 多连接，共享，受限于数据库                                   |
| file                                                      | 存于本地文件中                                               | 多服务需要多拷贝，修改麻烦                                   |
| git                                                       | 共同维护配置仓库                                             | 通过分支区分各环境（SpringCloud官网）                        |
| [apolloconfig](https://gitee.com/apolloconfig/apollo.git) | 数据库、本地文件 <br/>单独部署服务、依赖Eureka 、Java        | [设计](https://www.apolloconfig.com/#/zh/design/apollo-design)  Namespace   <br/>与SpringCloud 很好衔接，支持事件驱动<br/><font color='red'>可通过UI页面配置</font> |
| [consul](https://www.consul.io)                           | go语言开发的服务注册、配置组件<br/>支持http和dns协议，<br/>采用http api 注册、配置 | 支持Service Mesh<br/>桥接服务网格与传统网络 ...              |
| [etcd3](https://pypi.org/project/etcd3/)                  | 高可用KV存储系统，<br/>用于分享配置,服务发现                 | k8s 中来维护服务状态信息，<br/>支持curl 等方式，写速度快<br/>使用 Raft 实现分布[式 |
| [nacos](https://nacos.io/zh-cn/docs/what-is-nacos.html)   | ali开源发现、配置、管理服务                                  | [架构](https://nacos.io/zh-cn/docs/architecture.html) 有UI界面，<font color='red'>可通过UI页面配置</font> |
| zk                                                        | 对元数据管理、leader选举                                     | 大数据中协助服务（选举）、<br/>kafka中选举leader<br/> 无UI配置页面 |

\[Seata config 分析 github](https://github.com/seata/seata.git)、[Seata config 分析 gitee](https://gitee.com/mirrors/Seata.git)

#### 2.2 注册中心

常用的服务发现：file、zk、redis、nacos、eureka、consul、etcd3、sofa

| 名称                                 | 核心                                                         | 优劣                                                         |
| ------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| file                                 | 存储、读取、比较                                             | 共享文件                                                     |
| zk                                   | Znode的引用方式是路径引用                                    | 无UI                                                         |
| redis                                | 基于订阅与发布                                               |                                                              |
| nacos                                | ConcurrentHashMap、<br/>file、事件                           | 社区活跃                                                     |
| eureka                               | 3级缓存、instanceId、<br/>applicationName、ip+port、<br/> ConcurrentHashMap<String, Map<String, <br/>Lease<InstanceInfo>>>，外层map的key是<br/>appName，也就是服务名，<br/>内层map的key是instanceId | SpringCloud官网、停止维护                                    |
| consul                               | go语言开发                                                   |                                                              |
| etcd3                                | 高可用KV存储系统，<br/>用于分享配置,服务发现                 | CoreOS、Kubernetes和CloudFoundry<br/>等知名项目均在生产环境中使用了etcd |
| [sofa](https://github.com/sofastack) | https://github.com/sofastack                                 | 金融级云原生架构的中间件                                     |



#### 2.3 网关

| 名称                             | 核心   | 优劣 |
| -------------------------------- | ------ | ---- |
| SpringCloud Zuul                 | Filter | 同步 |
| SpringCloud GateWay              | React  | 异步 |
| [Kong](https://docs.konghq.com/) |        |      |





#### 2.4 服务间调用



#### 2.5 限流



#### 2.6 消息中间件



#### 2.7 服务治理




### 3.微服务应用











#### 参考文档



